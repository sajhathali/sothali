// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client-js"
  output   = "../src/generated/prisma"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Donation {
  id                  String   @id @default(cuid())
  createdAt           DateTime @default(now())
  updatedAt           DateTime @updatedAt

  // Donor Information
  donorName           String
  phone               String
  email               String?
  aadhaarNumber       String?
  addressLine         String
  city                String?
  pincode             String?
  geoLat              Float?   // optional if using map picker
  geoLng              Float?

  // Food Details
  foodTypes           String   // CSV or JSON string of types (Cooked, Raw, etc.)
  numberOfItems       Int?
  description         String?
  quantityServings    Int?
  preparedAt          DateTime?
  expiresAt           DateTime?

  // Logistics
  preferredPickupSlot String?  // Morning | Afternoon | Evening | ASAP
  deliveryPossible    Boolean  @default(false)
  specialInstructions String?

  // Verification & Consent
  photoUrl            String?  // stored in Vercel Blob
  safetyConfirmed     Boolean  @default(false)
  acceptedTerms       Boolean  @default(false)

  // System
  referenceCode       String   @unique
}

model NGO {
  id                  String   @id @default(cuid())
  createdAt           DateTime @default(now())
  updatedAt           DateTime @updatedAt

  // Organization Info
  name                String
  registrationNumber  String?
  establishedYear     Int?
  orgType             String   // NGO | Ashram | Charitable Trust | Other
  registrationFileUrl String?

  // Contact Details
  contactPerson       String
  contactPhone        String
  contactEmail        String
  website             String?

  // Location
  addressLine         String
  city                String?
  state               String?
  pincode             String?
  geoLat              Float?
  geoLng              Float?

  // Operational Details
  serviceAreas        String?  // CSV/JSON multi-select
  capacityPerDay      Int?
  preferredDonations  String?  // CSV/JSON multi-select

  // Verification & Consent
  idProofUrl          String?
  logoUrl             String?
  infoValidityConfirm Boolean   @default(false)
  acceptedTerms       Boolean   @default(false)

  // System
  ngoCode             String   @unique
}

model Review {
  id          String   @id @default(cuid())
  createdAt   DateTime @default(now())
  name        String
  email       String?
  role        String   // Donor | NGO | Beneficiary | Other
  text        String
  rating      Int      // 1..5
  approved    Boolean  @default(true) // default approved for seeded samples
}

model ContactMessage {
  id          String   @id @default(cuid())
  createdAt   DateTime @default(now())
  name        String
  email       String
  phone       String?
  subject     String
  message     String
  handled     Boolean  @default(false)
}
